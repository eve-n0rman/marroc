<!DOCTYPE html>
<html>
<head>
    <title>How Long since Marroc Lost A Exequror</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>
    <style>
    h1 {
        height: 100%;
        width: 100%;
        display: flex;
        position: fixed;
        align-items: center;
        justify-content: center;
    }
    </style>
</head>
<body>
<h1>It has been&nbsp;<a href=# id="lastkill" target=#><span id="howlong"></span></a>&nbsp;since Marroc lost an Exequror</h1>
<script>
function upTime(countTo) {
  var difference = moment.utc().from(countTo, true);
  span = document.getElementById("howlong");
  txt = document.createTextNode(difference);
  span.innerText = txt.textContent;
  clearTimeout(upTime.to);
  upTime.to=setTimeout(function(){ upTime(countTo); },1000);
}

function refreshKill() {
    var req = new XMLHttpRequest(); // a new request
    var kill;
    req.open("GET","https://zkillboard.com/api/characterID/96875547/losses/shipTypeID/634/limit/1/",true);
    req.onreadystatechange = function() {
      if (req.readyState == 4) {
        kill = JSON.parse(req.responseText)
        var killtime = kill[0].killTime;
        var killid = kill[0].killID;
        var url = "https://zkillboard.com/kill/" + killid + "/";
        var link = document.getElementById("lastkill");
        link.setAttribute("href", url);
        var since = moment.utc(kill[0].killTime, "YYYY-MM-DD hh:mm:ss");
        upTime(since);
        refreshKill.to=setTimeout(function() { refreshKill(); }, 60000);
      }
    }
    req.send();
}

window.onload=refreshKill()
</script>
</body>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-101116204-1', 'auto');
  ga('send', 'pageview');

</script>
</html>
